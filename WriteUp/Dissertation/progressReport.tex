\documentclass[10pt, a4paper]{article}

\input{./main.tex}
%\frenchspacing			to get rid of the double spaces after full stops
%\graphicspath{}			if you have trouble getting images in the thing, asks for graphics in the same folder
\usepackage{caption}
\captionsetup{justification=raggedright,singlelinecheck=false}
 \usepackage[none]{hyphenat}

\begin{document}
\begin{center}
\Huge{Part II Project - Progress Report} \\
\Large{\today} \\
\end{center}
\textbf{Name:} Alex Riddell-Webster \\
\textbf{College:} Murray Edwards \\
\textbf{Email Address:} ahr38@cam.ac.uk \\
\textbf{Director of Studies:} Luana Bulat \\
\textbf{Supervisor:} Matthew Ireland \\
\textbf{UTO:} Professor Jon Crowcroft\\
\textbf{Overseers:}  Ferenc Huszar and Andreas Vlachos \\
\textbf{Title:} A MANET to Facilitate Collision Avoidance in Rowing Boats
\vspace{20px}\\
My project, a mobile ad-hoc network (MANET) to facilitate collision avoidance in rowing boats, attempts to reduce the frequency of rowing boat collisions. The technical core of the project is the Epidemic routing protocol \hyperref[epidemic]{[1]}, modified to include medium access control based on the Multiple Access with Collision Avoidance for Wireless (MACAW) protocol \hyperref[macaw]{[2]}. Both medium access control and Epidemic are implemented in the by the same state machine, to simplify the implementation and prevent work being repeated -- a waste of the limited resources on the Raspberry Pi Pico \hyperref[pico]{[3]}. The initial state machine is shown in Figure 1, although it has been changed during implementation. Most notably, data send (DS) packets have been removed and the information being put into the data packets to reduce the number of packets sent. \\ \\
\begin{figure}[h]
\caption{Network state machine}
\begin{center}
\includegraphics[scale=0.4]{net.jpg}
\end{center}
\end{figure} \\
Construction of the MANET is going well. It has been constructed in hardware, working with the Raspberry Pi Pico, an ARM-based microcontroller without an operating system \hyperref[pico]{[3]} and RFM69 radio. I have finished the networking machine so am currently tweaking and evaluating the network state machine while finishing the application machine. As the network has a physical implementation, I intend to test the network on rowing boats, the environment it would be used. \\ \\
To ensure the network was delay tolerant, I ran a test with three nodes, $A$, $B$ and $C$. At the start, nodes $A$ and $B$ were in range of each other and node $C$ was out of range. I set node $A$ up to generate random messages every 40 seconds, with a time to live (TTL) greater than 2 so the messages would survive for two `hops' across the network. I then moved node $B$ out of range of node $A$ and into range of node $C$, which then displayed any messages it received so I could check that they were the same as those generated by $A$, with a reduced TTL. Figure 2 shows the setup.
\begin{figure}[h]
\caption{Using three nodes to check the network is delay tolerant}
\begin{center}
\includegraphics[scale=0.4]{test1.jpg}
\end{center}
\end{figure} \\
Another test involved four connected nodes, $A$, $B$, $C$, and $D$, where the transmit power of each node was significantly reduced, so each node had at most two connections. Node $A$ generated messages, and I checked to see if $D$ received them. I will use a similar set up in the future to test the percentage delivery and latency of packets. The setup is shown in Figure 3.
\begin{figure}[h]
\caption{Using four nodes to check the network can transfer packets over several links}
\begin{center}
\includegraphics[scale=0.4]{test2.jpg}
\end{center}
\end{figure} \\
The most significant obstacles have been in radio communication. The FIFO buffer on the RFM69 was occasionally being overwritten as the controlling library was not clearing the FIFO. I modified the library to clear the buffer and allow the sending of fixed length packets. Changing to fixed length packets (64 bytes, the maximum length of the FIFO) allowed for more reliable communication. Additionally, CircuitPython (the language in which AdaFruit's libraries are written) does not support interrupts. To work around this, I poll to see if a condition is met when a corresponding timer elapses. \\ \\
Given the work completed so far, I am two weeks behind the timetable laid out in October. As I am working on the application machine and evaluation of the network in parallel, the project will likely be back on timetable by mid-February. \\ \\
The remaining work is first to finish the application machine and evaluate the MANET. Evaluation metrics will include the percentage of received packets, transfer delay and variance, and the time taken to propagate messages in a previously segmented network. Finally, I will pull the application and network machines together, running them on the two cores in the Pico, with concurrency control over key data structures and the GPS chip. A concern here is the Adafruit Blinka libraries allowing interoperability between CircuitPython and MicroPython \hyperref[blinka]{[4]}, given the errors and incompleteness found in other libraries. 

\section*{References}
\label{epidemic}[1] Epidemic Routing for Partially-Connected Ad Hoc Networks. Vahdat, A, Becker, D. Duke University. 2000. \\ \\ 
\label{macaw}[2] MACAW: A Media Access Protocol for Wireless LAN's. Bharghavan, V, Demers, A, Shenker, S, Zhang, L. ACM SIGCOMM Conference. 1994. \\ \\ 
\label{pico}[3] RP2040 Datasheet A microcontroller by Raspberry Pi. Raspberry Pi Ltd. 2022. \\ \\ 
\label{blinka}[4] GitHub - adafuit/Adafruit\_Blinka: Add CircuitPython hardware API and libraries to MicroPython \& CPython devices. \url{https://github.com/adafruit/Adafruit_Blinka}. Adafruit Industries. GitHub. Accessed January 2023. 

\end{document}






